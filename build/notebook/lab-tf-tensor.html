
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab I: 線性代數 &#8212; 統計建模技法 v0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Lab-I:-線性代數">
<h1>Lab I: 線性代數<a class="headerlink" href="#Lab-I:-線性代數" title="Permalink to this headline">¶</a></h1>
<p>此 lab 中，我們將會透過 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 此套件，學習以下的主題。</p>
<ol class="arabic simple">
<li><p>認識 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 的張量（tensor）之基礎。</p></li>
<li><p>了解如何對 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 張量進行操弄。</p></li>
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 進行線性代數之運算。</p></li>
<li><p>應用前述之知識，建立一可進行線性迴歸分析之類型（class）。</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">tensorflow</span></code>之安裝與基礎教學，可參考 <a class="reference external" href="https://www.tensorflow.org">tensorflow官方網頁</a>。在安裝完成後，可透過以下的指令載入</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
<div class="section" id="張量之基礎">
<h2>張量之基礎<a class="headerlink" href="#張量之基礎" title="Permalink to this headline">¶</a></h2>
<div class="section" id="張量之輸入">
<h3>張量之輸入<a class="headerlink" href="#張量之輸入" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 最基本的物件是張量（tensor），其與 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 的陣列（array）相當的類似。產生一個張量最基本的方法為，將所欲形成張量的資料（其可為 <code class="docutils literal notranslate"><span class="pre">python</span></code> 的 <code class="docutils literal notranslate"><span class="pre">list</span></code> 或是 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 的 <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>），置於<code class="docutils literal notranslate"><span class="pre">tf.constant</span></code>函數中</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
<span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensorflow.python.framework.ops.EagerTensor
</pre></div></div>
</div>
<p>透過 <code class="docutils literal notranslate"><span class="pre">type()</span></code>，可看見其屬於 <code class="docutils literal notranslate"><span class="pre">EagerTensor</span></code> 此一類型（class），若欲了解 <code class="docutils literal notranslate"><span class="pre">a</span></code> 的樣貌，我們可使用 <code class="docutils literal notranslate"><span class="pre">print</span></code> 指令來列印其主要的內容</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tf.Tensor(
[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]], shape=(3, 4), dtype=int32)
</pre></div></div>
</div>
<p>透過對 <code class="docutils literal notranslate"><span class="pre">a</span></code> 列印的結果，我們可觀察到：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> 內部的資料數值（value）為 <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4],</span> <span class="pre">[5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8],</span> <span class="pre">[9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12]]</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> 的形狀（shape）為 <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4)</span></code>，表示 <code class="docutils literal notranslate"><span class="pre">a</span></code> 為一 <span class="math notranslate nohighlight">\(3 \times 4\)</span> 之張量。在進行運算時，張量間的形狀需滿足某些條件，如相同，或是滿足某種廣播（broadcasting）的規則</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> 的資料類型（data type）為 <code class="docutils literal notranslate"><span class="pre">int32</span></code>，表示32位元的整數。在進行運算時，張量間的類型須相同。一般來說，</p></li>
</ul>
</div>
<div class="section" id="張量之數值">
<h3>張量之數值<a class="headerlink" href="#張量之數值" title="Permalink to this headline">¶</a></h3>
<p>若要獲得張量的資料數值（value），可透過 <code class="docutils literal notranslate"><span class="pre">.numpy()</span></code>獲得，其回傳該張量對應之 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 陣列</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data of tensor is&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
data of tensor is [[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]]
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 內建了多種函數，以協助產生具有特別數值結構之張量：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with all elements being ones </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with all elements being zeros </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;identity matrix like tensor </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_rows</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num_columns</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diagonal matrix </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">diagonal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor with all elements being ones
 [[1.]
 [1.]
 [1.]
 [1.]]
tensor with all elements being zeros
 [[0. 0. 0.]
 [0. 0. 0.]]
identity matrix like tensor
 [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
diagonal matrix
 [[1 0 0 0]
 [0 2 0 0]
 [0 0 3 0]
 [0 0 0 4]]
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 亦可指定分配產生隨機的資料</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with random elements from uniform(0, 1) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                        <span class="n">minval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">seed</span> <span class="o">=</span> <span class="mi">48</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with random elements from normal(0, 1) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                       <span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stddev</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">seed</span> <span class="o">=</span> <span class="mi">48</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor with random elements from uniform(0, 1)
 [[0.7694951  0.5185194  0.8571981  0.33466458 0.7664865  0.75901115]
 [0.9016845  0.0850749  0.70721173 0.20442617 0.68416953 0.6725856 ]]
tensor with random elements from normal(0, 1)
 [[-0.0840444  -0.7190117 ]
 [ 0.47842062 -0.28157794]
 [-0.7281299   0.04126988]]
</pre></div></div>
</div>
</div>
<div class="section" id="張量之形狀">
<h3>張量之形狀<a class="headerlink" href="#張量之形狀" title="Permalink to this headline">¶</a></h3>
<p>張量之形狀與形狀之維度數量，可透過張量物件的 <code class="docutils literal notranslate"><span class="pre">.shape</span></code> 與 <code class="docutils literal notranslate"><span class="pre">ndim</span></code> 方法來獲得</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape of tensor is&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ndim of tensor is&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
shape of tensor is (3, 4)
ndim of tensor is 2
</pre></div></div>
</div>
<p>如果要對張量的形狀進行改變的話，可透過 <code class="docutils literal notranslate"><span class="pre">tf.reshape()</span></code> 此函數</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with shape (4, 3): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with shape (2, 2, 3): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with shape (12, 1): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with shape (12, 1) by (-1, 1): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor with shape (12,): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor with shape (4, 3):
 [[ 1  2  3]
 [ 4  5  6]
 [ 7  8  9]
 [10 11 12]]
tensor with shape (2, 2, 3):
 [[[ 1  2  3]
  [ 4  5  6]]

 [[ 7  8  9]
  [10 11 12]]]
tensor with shape (12, 1):
 [[ 1]
 [ 2]
 [ 3]
 [ 4]
 [ 5]
 [ 6]
 [ 7]
 [ 8]
 [ 9]
 [10]
 [11]
 [12]]
tensor with shape (12, 1) by (-1, 1):
 [[ 1]
 [ 2]
 [ 3]
 [ 4]
 [ 5]
 [ 6]
 [ 7]
 [ 8]
 [ 9]
 [10]
 [11]
 [12]]
tensor with shape (12,):
 [ 1  2  3  4  5  6  7  8  9 10 11 12]
</pre></div></div>
</div>
<p>注意，<code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">1)</span></code> 與 <code class="docutils literal notranslate"><span class="pre">(12,)</span></code> 兩種形狀是不一樣的，前者為2d的張量，後者為1d的張量。在進行張量操弄時，若將兩者混淆，很可能會帶來錯誤的計算結果。</p>
</div>
<div class="section" id="張量之資料類型">
<h3>張量之資料類型<a class="headerlink" href="#張量之資料類型" title="Permalink to this headline">¶</a></h3>
<p>張量的資料類型，可透過 <code class="docutils literal notranslate"><span class="pre">.dtype</span></code> 方法獲得</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data type of tensor is&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
data type of tensor is &lt;dtype: &#39;int32&#39;&gt;
</pre></div></div>
</div>
<p>若是要調整資料類型的話，則可透過 <code class="docutils literal notranslate"><span class="pre">tf.cast()</span></code>此函數</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;tf.Tensor: shape=(3, 4), dtype=float32, numpy=
array([[ 1.,  2.,  3.,  4.],
       [ 5.,  6.,  7.,  8.],
       [ 9., 10., 11., 12.]], dtype=float32)&gt;
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 內建多種資料類型，包含整數類型（如 <code class="docutils literal notranslate"><span class="pre">tf.int32</span></code> 與 <code class="docutils literal notranslate"><span class="pre">tf.int64</span></code>）與浮點數類型（如 <code class="docutils literal notranslate"><span class="pre">tf.float32</span></code> 與 <code class="docutils literal notranslate"><span class="pre">tf.float64</span></code>），完整的資料類型請見 <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/dtypes/DType">tf.dtypes.DType</a>。</p>
<p>在進行張量的數學運算時，請務必確認張量間的資料類型都是一致的，而 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 常用之資料類型為 <code class="docutils literal notranslate"><span class="pre">tf.float32</span></code> 與 <code class="docutils literal notranslate"><span class="pre">tf.float64</span></code>，前者所需的記憶體較小，但運算結果的數值誤差較大。</p>
</div>
</div>
<div class="section" id="張量之操弄">
<h2>張量之操弄<a class="headerlink" href="#張量之操弄" title="Permalink to this headline">¶</a></h2>
<div class="section" id="張量之切片">
<h3>張量之切片<a class="headerlink" href="#張量之切片" title="Permalink to this headline">¶</a></h3>
<p>若要擷取一張量特定的行（row）或列（column）的話，則可透過切片（slicing）的功能獲得。<code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 張量的切片方式，與 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 類似，皆使用中括號 <code class="docutils literal notranslate"><span class="pre">[]</span></code>，再搭配所欲擷取資料行列的索引（index）獲得。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extract 1st row: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extract 1st and 2nd rows: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extract 2nd column: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">a</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extract 2nd and 3rd columns: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">a</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
extract 1st row:
 [1 2 3 4]
extract 1st and 2nd rows:
 [[1 2 3 4]
 [5 6 7 8]]
extract 2nd column:
 [ 2  6 10]
extract 2nd and 3rd columns:
 [[ 2  3]
 [ 6  7]
 [10 11]]
</pre></div></div>
</div>
<p>進行切片時，有幾項重點需要注意。</p>
<ul class="simple">
<li><p>各面向之索引從0開始。</p></li>
<li><p>負號表示從結尾數回來，如 <code class="docutils literal notranslate"><span class="pre">-1</span></code> 表示最後一個位置。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:</span></code>表示該面向所有元素皆挑選。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start:stop</span></code> 表示從 <code class="docutils literal notranslate"><span class="pre">start</span></code> 開始挑選到 <code class="docutils literal notranslate"><span class="pre">stop-1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start:stop:step</span></code> 表示從 <code class="docutils literal notranslate"><span class="pre">start</span></code> 開始到 <code class="docutils literal notranslate"><span class="pre">stop-1</span></code>，間隔 <code class="docutils literal notranslate"><span class="pre">step</span></code> 挑選。</p></li>
</ul>
</div>
<div class="section" id="張量之串接">
<h3>張量之串接<a class="headerlink" href="#張量之串接" title="Permalink to this headline">¶</a></h3>
<p>多個張量在維度可對應之前提下，可透過 <code class="docutils literal notranslate"><span class="pre">tf.concat</span></code> 串接</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vertical concatenation </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;horizontal concatenation </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
vertical concatenation
 [[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]
 [ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]]
horizontal concatenation
 [[ 1  2  3  4  1  2  3  4]
 [ 5  6  7  8  5  6  7  8]
 [ 9 10 11 12  9 10 11 12]]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="張量之運算">
<h2>張量之運算<a class="headerlink" href="#張量之運算" title="Permalink to this headline">¶</a></h2>
<p>考慮以下 <code class="docutils literal notranslate"><span class="pre">a</span></code> 與 <code class="docutils literal notranslate"><span class="pre">b</span></code> 兩張量</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor b is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor a is
 [[1. 2.]
 [3. 4.]
 [5. 6.]]
tensor b is
 [[1. 2.]
 [1. 2.]
 [1. 2.]]
</pre></div></div>
</div>
<p>我們將使用 <code class="docutils literal notranslate"><span class="pre">a</span></code> 與 <code class="docutils literal notranslate"><span class="pre">b</span></code> 來展示如何使用 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 進行張量間的計算。</p>
<div class="section" id="張量元素對元素之運算">
<h3>張量元素對元素之運算<a class="headerlink" href="#張量元素對元素之運算" title="Permalink to this headline">¶</a></h3>
<p>透過 <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 的數學函數，可進行張量元素對元素的四則運算</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise add </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise subtract </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise multiply </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise divide </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
element-wise add
 tf.Tensor(
[[2. 4.]
 [4. 6.]
 [6. 8.]], shape=(3, 2), dtype=float64)
element-wise subtract
 tf.Tensor(
[[0. 0.]
 [2. 2.]
 [4. 4.]], shape=(3, 2), dtype=float64)
element-wise multiply
 tf.Tensor(
[[ 1.  4.]
 [ 3.  8.]
 [ 5. 12.]], shape=(3, 2), dtype=float64)
element-wise divide
 tf.Tensor(
[[1. 1.]
 [3. 2.]
 [5. 3.]], shape=(3, 2), dtype=float64)
</pre></div></div>
</div>
<p>前述採用的函數，皆可取代為其所對應之運算子計算</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise add </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise subtract </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise multiply </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;element-wise divide </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
element-wise add
 tf.Tensor(
[[2. 4.]
 [4. 6.]
 [6. 8.]], shape=(3, 2), dtype=float64)
element-wise subtract
 tf.Tensor(
[[0. 0.]
 [2. 2.]
 [4. 4.]], shape=(3, 2), dtype=float64)
element-wise multiply
 tf.Tensor(
[[ 1.  4.]
 [ 3.  8.]
 [ 5. 12.]], shape=(3, 2), dtype=float64)
element-wise divide
 tf.Tensor(
[[1. 1.]
 [3. 2.]
 [5. 3.]], shape=(3, 2), dtype=float64)
</pre></div></div>
</div>
<p>若需要進行絕對值、對數、指數等較為進階之數學運算，可以至 <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/math">tf.math</a> 此模組中尋找對應的數學函數。</p>
</div>
<div class="section" id="張量線性代數之運算">
<h3>張量線性代數之運算<a class="headerlink" href="#張量線性代數之運算" title="Permalink to this headline">¶</a></h3>
<p>除了簡單的四則運算外，當張量的 <code class="docutils literal notranslate"><span class="pre">ndim</span></code> 為2時，<code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> 提供了進行線性代數（linear algebra）相關的函數，如</p>
<ul class="simple">
<li><p>矩陣轉置（matrix transpose）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a_transpose</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;transpose of a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">a_transpose</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
transpose of a is
 [[1. 3. 5.]
 [2. 4. 6.]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>矩陣乘法（matrix multiplication）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># equivalent to tf.linalg.matmul(a, a_transpose)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a_transpose</span> <span class="o">@</span> <span class="n">a</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c = a_transpose @ a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">c</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
c = a_transpose @ a is
 [[35. 44.]
 [44. 56.]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>反矩陣（matrix inverse）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c_inv</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inverse of c is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">c_inv</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span> <span class="c1"># c @ c_inv should be identity matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check for inverse (left) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="n">c_inv</span> <span class="o">@</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check for inverse (right) </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="n">c</span> <span class="o">@</span> <span class="n">c_inv</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
inverse of c is
 [[ 2.33333333 -1.83333333]
 [-1.83333333  1.45833333]]
check for inverse (left)
 [[1.00000000e+00 1.42108547e-14]
 [0.00000000e+00 1.00000000e+00]]
check for inverse (right)
 [[1.00000000e+00 0.00000000e+00]
 [1.42108547e-14 1.00000000e+00]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>Cholesky 拆解（Cholesky decomposition）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c_chol</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cholesky factor of c is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">c_chol</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check for Cholesky decomposition </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="n">c_chol</span> <span class="o">@</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">c_chol</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cholesky factor of c is
 [[5.91607978 0.        ]
 [7.43735744 0.82807867]]
check for Cholesky decomposition
 [[35. 44.]
 [44. 56.]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>特徵拆解（eigen-decomposition）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eigenvalue of c is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">e</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eigenvector of c is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check for eigen-decomposition </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="n">v</span> <span class="o">@</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">diagonal</span> <span class="o">=</span> <span class="n">e</span><span class="p">)</span> <span class="o">@</span>
       <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
eigenvalue of c is
 [ 0.26450509 90.73549491]
eigenvector of c is
 [[-0.78489445 -0.61962948]
 [ 0.61962948 -0.78489445]]
check for eigen-decomposition
 [[35. 44.]
 [44. 56.]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>奇異值拆解（singular value decomposition）</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;singular value of a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">s</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;left singular vector of a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">u</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;right singular vector of a is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;check for singular value decomposition </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="p">(</span><span class="n">u</span> <span class="o">@</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">diagonal</span> <span class="o">=</span> <span class="n">s</span><span class="p">)</span> <span class="o">@</span>
       <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
singular value of a is
 [9.52551809 0.51430058]
left singular vector of a is
 [[ 0.2298477  -0.88346102]
 [ 0.52474482 -0.24078249]
 [ 0.81964194  0.40189603]]
right singular vector of a is
 [[ 0.61962948  0.78489445]
 [ 0.78489445 -0.61962948]]
check for singular value decomposition
 [[1. 2.]
 [3. 4.]
 [5. 6.]]
</pre></div></div>
</div>
</div>
<div class="section" id="對張量之數值進行摘要">
<h3>對張量之數值進行摘要<a class="headerlink" href="#對張量之數值進行摘要" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">tf.math</span></code> 提供了一些化約（reduce）的函數，對張量內的數值進行摘要</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate mean </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate standard deviation </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_std</span><span class="p">(</span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate max </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_max</span><span class="p">(</span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate min </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
calculate mean
 3.5
calculate standard deviation
 1.707825127659933
calculate max
 6.0
calculate min
 1.0
</pre></div></div>
</div>
<p>我們亦可對張量的各面向，進行前述的摘要。以平均數為例：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate mean for each column </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span>
          <span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculate mean for each row </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span>
          <span class="n">input_tensor</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
calculate mean for each column
 [3. 4.]
calculate mean for each row
 [1.5 3.5 5.5]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="實徵範例">
<h2>實徵範例<a class="headerlink" href="#實徵範例" title="Permalink to this headline">¶</a></h2>
<div class="section" id="產生線性迴歸資料">
<h3>產生線性迴歸資料<a class="headerlink" href="#產生線性迴歸資料" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define a function to generate x and y</span>
<span class="k">def</span> <span class="nf">generate_data</span><span class="p">(</span><span class="n">n_sample</span><span class="p">,</span> <span class="n">coef</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sd_residual</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="n">mean_feature</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sd_feature</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">n_feature</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_sample</span><span class="p">,</span> <span class="n">n_feature</span><span class="p">),</span>
                         <span class="n">mean</span> <span class="o">=</span> <span class="n">mean_feature</span><span class="p">,</span>
                         <span class="n">stddev</span> <span class="o">=</span> <span class="n">sd_feature</span><span class="p">,</span>
                         <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                         <span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">stddev</span> <span class="o">=</span> <span class="n">sd_residual</span><span class="p">,</span>
                         <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">x</span> <span class="o">@</span> <span class="n">coef</span> <span class="o">+</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># run generate_data</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">(</span>
    <span class="n">n_sample</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sd_residual</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mean_feature</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">sd_feature</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">48</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;feature matrix x is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;response vector y is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
feature matrix x is
 [[ 5.48848568 13.61840308 15.88021677]
 [11.37361141 10.45760477  7.29207417]
 [ 8.76283527  7.25985482  4.44062436]
 [ 6.44741895 12.51466253 11.91473433]
 [13.05764078 12.00758984  8.85894785]
 [16.00571498  6.44779053  6.17078322]
 [ 9.45319088 12.23745452  5.14101102]
 [10.99438762  3.68643527  8.68771621]
 [ 8.10937642  6.67353645  8.66068655]
 [12.13642167  7.61931554 10.45228741]]
response vector y is
 [[ 19.08869209]
 [-21.47155787]
 [-18.28819253]
 [ 11.00760759]
 [-24.22280723]
 [-55.18004606]
 [ -5.9423839 ]
 [-39.84312934]
 [-15.45899857]
 [-31.83700397]]
</pre></div></div>
</div>
</div>
<div class="section" id="計算模型參數">
<h3>計算模型參數<a class="headerlink" href="#計算模型參數" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define a function to calculate model parameter</span>
<span class="k">def</span> <span class="nf">calculate_parameter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">dtype</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">dtype</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">x_design</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parameter</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> <span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> \
                <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> <span class="n">y</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># run calculate_parameter</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">(</span>
    <span class="n">n_sample</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sd_residual</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">mean_feature</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">sd_feature</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">48</span><span class="p">)</span>
<span class="n">intercept</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="n">calculate_parameter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;intercept estimate is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">intercept</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coefficient estimate is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">coef</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
intercept estimate is
 4.75108692695553
coefficient estimate is
 [-5.01016455  3.0247444   0.00671568]
</pre></div></div>
</div>
</div>
<div class="section" id="建立一進行迴歸分析之物件">
<h3>建立一進行迴歸分析之物件<a class="headerlink" href="#建立一進行迴歸分析之物件" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define a class to fit linear regression</span>
<span class="k">class</span> <span class="nc">LinearRegression</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">x_design</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> <span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> \
                <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x_design</span><span class="p">)</span> <span class="o">@</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">linear_regression</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">linear_regression</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">intercept</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">coef</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.75108692695553
[-5.01016455  3.0247444   0.00671568]
</pre></div></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">統計建模技法</a></h1>



<p class="blurb">Techniques in Statistical Modeling</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mathematics-prerequisite.html">1. 先備數學知識</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear-regression.html">2. 線性迴歸</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab-torch-tensor.html">3. Lab I: 線性代數</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistic-regression.html">4. 邏輯斯迴歸</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab-torch-optimization.html">5. Lab II: 數值優化</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability-distribution.html">6. 機率分佈</a></li>
<li class="toctree-l1"><a class="reference internal" href="maximum-likelihood.html">7. 最大概似法</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood-inference.html">8. 概似推論</a></li>
<li class="toctree-l1"><a class="reference internal" href="true-score-model.html">9. 真實分數模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="factor-analysis-I.html">10. 因素分析-I</a></li>
<li class="toctree-l1"><a class="reference internal" href="factor-analysis-II.html">11. 因素分析-II</a></li>
<li class="toctree-l1"><a class="reference internal" href="item-response-theory-I.html">12. 試題反應理論-I</a></li>
<li class="toctree-l1"><a class="reference internal" href="item-response-theory-II.html">13. 試題反應理論-II</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixture-modeling.html">14. 混合建模</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Po-Hsien Huang.
      
      |
      <a href="../_sources/notebook/lab-tf-tensor.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>